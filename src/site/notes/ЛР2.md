---
{"dg-publish":true,"permalink":"/lr-2/"}
---

# Межанов Василий Сергеевич 2022-ФГиИБ-ИБ-1б
## Linux Access Control Lists

Представьте себе систему, в которой есть следующие пользователи:

- student01;
- student02;
- student03;
- student04;
- student05;
- student06;

Все эти пользователи - студенты одной конкретной группы.

Причем, **student01** и **student02** ответственны за администрирование компьютера, поэтому являются членами группы **sysop** (system operator).
![Снимок экрана 2025-02-18 в 10.41.53.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2010.41.53.png)
Создаем пользователей Student01,02,03,04,05,06
![Снимок экрана 2025-02-18 в 10.43.13.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2010.43.13.png)
Добавляем Студентов 01 и 02 в группу sysop, так как они являются ответственными за администрирование компьютера
![Снимок экрана 2025-02-18 в 11.00.44.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.00.44.png)
Пользователь **student03** создает файл _student03.script.sh_.
![Снимок экрана 2025-02-18 в 12.03.20.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2012.03.20.png)

После выполнения команды `ls -l` мы видим следующие права:

```
-rwxr-xr-- 1 student03 sysop  0 Feb 18 10:59  student03.script.sh
```


---

Мы хотим дать пользователю **student04** права на чтение и запись (но не исполнение).
_Почему мы не можем это сделать?_
Cтандартная модель прав доступа не позволяет наделять особыми правами отдельных пользователей

### 1.Установка acl
![Снимок экрана 2025-02-18 в 11.02.01.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.02.01.png)
Устанавливаем и изучаем возможности `acl` с помощью следующих команд:

```
apk add acl
getfacl -h
setfacl -h
```

### 2. Практика

**2.1. Изучите с помощью getfacl права файла student03.script.sh**

![Снимок экрана 2025-02-18 в 11.02.45 1.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.02.45%201.png)
**2.2. С помощью setfacl предоставьте пользователь student04 права на чтение и запись скрипты student03.script.sh**.
![Снимок экрана 2025-02-18 в 11.04.13.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.04.13.png)
**2.3. В дополнение к трем пользователям из ЛР01, создайте еще двух пользователей (user4, user5). Затем создайте еще одну группу (напр. group2) и поместите в нее новых пользователей (user4, user5).**
![Снимок экрана 2025-02-18 в 11.06.10.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.06.10.png)

**2.4. Внутри директории пользователя user5 создайте от его имени директорию important_files**.
![Снимок экрана 2025-02-18 в 11.07.12 1.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.07.12%201.png)
Есть ли разница между выводом `ls -l` и `getfacl`?
Разницы нет
**2.5. Зайдите под четвертым (user4) (относительно пользователей из ЛР01) и выполните следующие действия:**

- Попытайтесь добавить новую директорию внутри _important_files_. Можете ли вы это сделать? ![Снимок экрана 2025-02-18 в 11.09.06.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.09.06.png)
Не получится, так как у user4 нет прав внутри папок, которые принадлежат другим пользователям
- Добавьте новое **ACL** правило для директории _important_files_ такое, чтобы четвертый пользователь (user4) имел права `rwx`;
- ![Снимок экрана 2025-02-18 в 11.10.44.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.10.44.png)
- Есть ли разница между выводом `ls -l` и `getfacl` для _important_files_? Почему?
![Снимок экрана 2025-02-18 в 11.10.44 1.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.10.44%201.png)
![Снимок экрана 2025-02-18 в 11.12.17.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.12.17.png)
Отличается, конечно, в ls -l не отображаются права user4
- Попытайтесь добавить новую директорию снова от имени четвертого пользователя (**user4**) внутри _important_files_. Можете ли вы это сделать? Почему?
![Снимок экрана 2025-02-18 в 11.15.03.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.15.03.png)
Получилось, так как 2 шага назад выделили права на это. 
**2.6. Авторизуйтесь под именем пятого пользователя (user5) и выполните следующие действия:**

- Попытайтесь создать какой-нибудь файл внутри директории четвертого пользователя из предыдущего шага. Можете ли вы это сделать? Почему?
- ![Снимок экрана 2025-02-18 в 11.17.13.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.17.13.png)
- Не могу сделать, так как аудитория принадлежит пользователю user4

- Добавьте новое **ACL** правило для директории _important_files_ такое, чтобы группа из четвертого и пятого пользователя (group2) имела права `rwx`;
- ![Снимок экрана 2025-02-18 в 11.20.04.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.20.04.png)
- Попытайтесь создать какой-нибудь файл внутри директории четвертого пользователя из предыдущего шага. Можете ли вы это сделать? Почему?
- ![Снимок экрана 2025-02-18 в 11.23.48.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.23.48.png)
- Не могу, конечно, что за шутки, мы права применили только для директории important files

**2.7. Снова авторизуйтесь под именем четвертого пользователя (user4) и создайте какой-либо файл в своей директории внутри _important_files_. Выполните следующие действия:**
![Снимок экрана 2025-02-18 в 11.22.09.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.22.09.png)
- Авторизуйтесь под пятым пользователем (**user5**). Можете ли вы отредактировать созданный файл? Почему?
    ![Снимок экрана 2025-02-18 в 11.23.48 1.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.23.48%201.png)
    Не могу отредактировать - прав недостаточно
- Добавьте новое **ACL** правило, которое разрешало бы пользователям второй группы (**group2**) редактировать любые файлы внутри директории четвертого пользователя (**user4**) внутри **important_files**;
    ![Снимок экрана 2025-02-18 в 11.26.42.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.26.42.png)
- Снова от имени четвертого пользователя (**user4**) создайте в описываемой директории новый файл;
    ![Снимок экрана 2025-02-18 в 11.27.43.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.27.43.png)
- Может ли теперь пятый пользователь (user5) редактировать эти файлы? Какие? Почему?
    ![Снимок экрана 2025-02-18 в 11.28.28.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.28.28.png)
    Пятый пользователь может отредактировать только первый файл, на второй файл не было достаточных полномочий 

**2.8. Покажите все созданные вами правила для второй группы (group2, внутри которой четвертый и пятый пользователи). Затем, удалите все эти правила.**
![Снимок экрана 2025-02-18 в 11.36.07.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.36.07.png)
![Снимок экрана 2025-02-18 в 11.36.18.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.36.18.png)
![Снимок экрана 2025-02-18 в 11.36.56.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.36.56.png)
![Снимок экрана 2025-02-18 в 11.37.19.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.37.19.png)
![Снимок экрана 2025-02-18 в 11.37.27.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.37.27.png)
**2.9. Авторизуйтесь по четвертым пользователем (user4). Создайте третий файл внутри своей директории внутри _important_files_**.
![Снимок экрана 2025-02-18 в 11.38.40.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.38.40.png)
**2.10. Может ли теперь пятый пользователь (user5) редактировать файлы внутри директории четвертого пользователя? Какие? Почему?**
![Снимок экрана 2025-02-18 в 11.39.12.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.39.12.png)
Не может, так как все права user5 мы удалили пару шагов назад
**2.11. Удалите все ACL правила для директории четвертого пользователя, затем повторите предыдущий шаг. Что изменилось? Почему?**.
![Снимок экрана 2025-02-18 в 11.41.11.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.41.11.png)
![Снимок экрана 2025-02-18 в 11.42.31.png](/img/user/%D0%A1%D0%BD%D0%B8%D0%BC%D0%BE%D0%BA%20%D1%8D%D0%BA%D1%80%D0%B0%D0%BD%D0%B0%202025-02-18%20%D0%B2%2011.42.31.png)
User5 по-прежнему не может ничего редактировать.